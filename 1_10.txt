#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h>
#define SIZE 33

int convert_to_decimal(char* number, int base) 
{
    if (!number)
    {
        return 0;
    }
    int sign = 1;
    char *ptr = NULL;
    int result = 0;

    if (*number == '-')
    {
        sign = -1;
        ptr = number;
    }

    else
    {
        ptr = number - 1;
    }

    while (*++ptr)
    {
        result = result * base + (isdigit(*ptr) ? *ptr  - '0' : *ptr - 'A' + 10);

    }

    return result * sign;
    
}

char* convert_to_base(int number, int base) 
{
    int sign = 1;
    if (number < 0)
    {
        sign = -1;
        number = sign * number;
    }
    int r;
    static char buf[SIZE];
    char* ptr = buf + SIZE - 1;
    *ptr = '\0';
    while(number > 0)
    {
        r = number % base;
        *--ptr = (r > 9)? r - 10 + 'A' : r + '0';
        number /= base;
    }
    return ptr;
}

int main() 
{
    int base;
    printf("Please, enter the base of the number system (2-36): ");
    scanf("%d", &base);
    if (base < 2 || base > 36) 
    {
        printf("ERROR! Invalid base!\n");
        return 1;
    }
    char number[100];
    int max_abs = 0;
    while (1) 
    {
        printf("Enter a number in base %d (or enter 'Stop' to finish): ", base);
        scanf("%s", number);
        if ((strcmp(number, "Stop") == 0) || (strcmp(number, "stop") == 0))
        {
            break;
        }
        int decimal = convert_to_decimal(number, base);
        if(decimal == 0)
        {
            printf("ERROR DETECTED! Invalid input: zero is not allowed!\n");
            return 1;
        }
        int abs_decimal = abs(decimal);
        if (abs_decimal > abs(max_abs)) 
        {
            max_abs = decimal;

        }
    
    }
    printf("Max value: %d\n", max_abs);
    printf("Max value in base 9: %s\n", convert_to_base(max_abs, 9));
    printf("Max value in base 18: %s\n", convert_to_base(max_abs, 18));
    printf("Max value in base 27: %s\n", convert_to_base(max_abs, 27));
    printf("Max value in base 36: %s\n", convert_to_base(max_abs, 36));
    return 0;
}